% \begin{table*}
% \centering
% \caption{
% Experiment of diagnosis classification.
% Classification accuracy (the higher the better) from a 5-folds cross-validation experiments is shown.
% On average, in-dataset (same) prediction performance is higher with respect to all other cases.
% Out-dataset prediction performance is higher if multiple dataset are pooled together (leave out test) with respect to the 
% average case where our model is trained with a single dataset (different).
% }
% \label{tab:dx_couples}
% \begin{tabular}{llllllll}
% \toprule
%        & classification\_test & \multicolumn{2}{l}{AD\_vs\_MCI} & \multicolumn{2}{l}{AD\_vs\_NC} & \multicolumn{2}{l}{MCI\_vs\_NC} \\
%        & model\_name &          mcvae &      missmcvae &          mcvae &      missmcvae &         mcvae &     missmcvae \\
% test\_dataset & aggr &                &                &                &                &               &               \\
% \midrule
% adni1 & within &   72.70 (3.72) &   72.87 (4.37) &   81.69 (2.97) &   81.51 (3.14) &  62.00 (8.91) &  62.90 (8.72) \\
%        & cross &   47.04 (5.88) &  47.74 (12.56) &  66.55 (15.29) &   72.30 (8.90) &  53.12 (6.42) &  59.65 (2.76) \\
%        & lodo &   50.09 (4.75) &   56.17 (4.29) &   66.55 (6.48) &   74.48 (3.06) &  53.12 (6.42) &  59.65 (2.76) \\
% adni2 & within &   50.58 (3.90) &   80.07 (2.53) &   82.86 (3.28) &   87.92 (3.46) &  58.63 (4.27) &  65.56 (1.11) \\
%        & cross &   61.04 (4.49) &   61.11 (4.21) &   67.59 (5.27) &   70.04 (6.55) &  63.05 (2.00) &  62.75 (1.80) \\
%        & lodo &              - &   68.46 (1.31) &   66.28 (4.35) &   83.89 (1.93) &  63.05 (2.00) &  62.75 (1.80) \\
% geneva & within &   65.76 (3.62) &   77.70 (8.12) &              - &              - &             - &             - \\
%        & cross &  33.89 (11.88) &  50.09 (21.50) &              - &              - &             - &             - \\
%        & lodo &  42.42 (14.70) &   56.70 (4.13) &              - &              - &             - &             - \\
% miriad & within &              - &              - &  83.85 (13.84) &  86.70 (15.68) &             - &             - \\
%        & cross &              - &              - &  64.95 (19.72) &  73.04 (15.31) &             - &             - \\
%        & lodo &              - &              - &  61.76 (18.25) &   92.53 (0.30) &             - &             - \\
% oasis3 & within &              - &              - &   74.47 (2.49) &   80.35 (3.59) &             - &             - \\
%        & cross &              - &              - &  60.50 (10.39) &  61.89 (13.23) &             - &             - \\
%        & lodo &              - &              - &   68.05 (6.41) &   75.43 (5.67) &             - &             - \\
% \bottomrule
% \end{tabular}
% \end{table*}

\begin{table}
\centering
\caption{
Number of subjects stratified by dataset and diagnosis:
Alzheimer's Disease (AD);
Mild Cognitive Impairment (MCI);
Normal Cognition (NC).
}
\label{tab:dx_stratification}
\begin{tabular}{lccccc}
\toprule
   &     AD &    MCI &     NC &  other & total \\
\midrule
Adni1   &  403 &  172 &  165 &   -  &  740 \\
Adni2   &  328 &  455 &  541 &   -  & 1324 \\
Geneva  &  147 &  405 &    - &  447 &  999 \\
Miriad  &   44 &   -  &   23 &   -  &   67 \\
Oasis3  &  149 &    - &  380 &   -  &  529 \\
\bottomrule
\end{tabular}
\end{table}


\begin{table*}
\centering
\caption{
Experiment of diagnosis classification run with the Multi-Channel VAE (MCVAE) and the Multi Task MCVAE (MT-MCVAE).
$5$-folds classification accuracy in $\%$ is shown as mean (standard deviation). 
Since there are no MCI in miriad and oasis3 datasets, the classification tests `AD vs MCI' and `MCI vs NC' are meaningless and not reported.
Since there are no NC in the geneva dataset, the classification tests `AD vs NC' and `MCI vs NC' are meaningless and not reported.
Experiments were run in two different conditions:
1) when training and testing data are chosen from the same dataset, or Single Task with Internal Benchmark (STIB) learning case;
2) when models trained on one dataset are tested on another dataset, or Single Task with External Benchmark (STEB) case.
%3) when models are trained on all the available datasets except the testing one, or Multi Task Learning (MTL).
In all cases the MT-MCVAE model performs either similarly or statistically better than the MCVAE, with alpha levels at $0.05$ (*), $0.01$ (**), and $0.001$ (***).
%The MTL cases could be fitted with the MT-MCVAE only.
%In $5/7$ of them (\dag) we measure on average a better performance with respect to the ST + TL cases fitted with the same model type.
}
\label{tab:classifier}
\resizebox{\textwidth}{!}{
\begin{tabular}{lllllllll}
\toprule
                &        & classification task    & \multicolumn{2}{c}{AD vs MCI} & \multicolumn{2}{c}{AD vs NC} & \multicolumn{2}{c}{MCI vs NC} \\
                &        & model          & \multicolumn{1}{c}{MCVAE}  & \multicolumn{1}{c}{MT-MCVAE} & \multicolumn{1}{c}{MCVAE}  & \multicolumn{1}{c}{MT-MCVAE} & \multicolumn{1}{c}{MCVAE}  & \multicolumn{1}{c}{MT-MCVAE} \\
\toprule
test dataset & condition & train dataset &                 &                        &                &                       &               &                       \\
\cmidrule(lr){1-3}
Adni1  &         STIB    & Adni1          &   72.70 (3.72)       &  72.87 (4.37)          &   81.69 (2.97) &   81.51 (3.14)        &  62.00 (8.91) &  62.90 (8.72)         \\
\cmidrule(lr){2-9}
       &         STEB    & Adni2          &   47.48 (3.56)       &  58.96 (3.55)$^{***}$  &   68.50 (4.86) &   73.77 (2.80)$^{*}$  &  53.12 (6.42) &  59.65 (2.76)$^{*}$   \\
       &                 & Miriad         &              -       &             -          &   82.58 (4.75) &   80.82 (3.16)        &             - &             -         \\
       &                 & Oasis3         &              -       &             -          &   48.57 (6.48) &   62.31 (6.43)$^{**}$ &             - &             -         \\
	&                 & Geneva        &   36.52 (5.29)       &  46.61 (8.03)$^{*}$    &              - &              -        &             - &             -         \\
%\cmidrule(lr){2-9}
%       &         MTL     & all but adni1  &  -                   &  56.17 (4.29)          &  -             &   74.48 (3.06)\dag    &  -            &             -         \\
\toprule
Adni2  &         STIB    & Adni2          &   50.58 (3.90)       &  80.07 (2.53)$^{***}$  &   82.86 (3.28) &   87.92 (3.46)$^{*}$  &  58.63 (4.27) &  65.56 (1.11)$^{**}$  \\
\cmidrule(lr){2-9}
       &         STEB    & Adni1          &   57.59 (2.61)       &  58.23 (2.87)          &   64.21 (3.36) &   64.21 (3.52)        &  63.05 (2.00) &  62.75 (1.80)         \\
       &                 & Miriad         &              -       &             -          &   70.32 (7.29) &   70.20 (7.17)        &             - &             -         \\
       &                 & Oasis3         &              -       &             -          &   68.24 (2.97) &   75.72 (1.90)$^{**}$ &             - &             -         \\
       &                 & Geneva         &   64.49 (2.98)       &  63.98 (3.30)          &              - &              -        &             - &             -         \\
%\cmidrule(lr){2-9}
%       &         MTL     & all but adni2  &              -       &  68.46 (1.31)\dag       &   -            &   83.89 (1.93)\dag    &  -            &             -         \\
\toprule
Geneva &         STIB    & Geneva         &   65.76 (3.62)       &  77.70 (8.12)$^{*}$    &              - &              -        &             - &             -         \\
\cmidrule(lr){2-9}
       &         STEB    & Adni1          &   29.17 (5.87)       &  30.08 (5.49)          &              - &              -        &             - &             -         \\
       &                 & Adni2          &  38.61 (15.08)       &  70.11 (2.90)$^{**}$   &              - &              -        &             - &             -         \\
%\cmidrule(lr){2-9}
%       &         MTL     & all but geneva &              -       &  56.70 (4.13) &               -         &              -        &             - &             -         \\
\toprule
Miriad &         STIB    & Miriad         &              -       &             -          &  83.85 (13.84) &  86.70 (15.68)        &             - &             -         \\
\cmidrule(lr){2-9}
       &         STEB    & Adni1          &              -       &             -          &  74.18 (14.37) &  74.18 (14.37)        &             - &             -         \\
       &                 & Adni2          &              -       &             -          &  74.95 (11.58) &  78.90 (11.54)$^{*}$  &             - &             -         \\
       &                 & Oasis3         &              -       &             -          &  45.71 (18.08) &  66.04 (19.35)        &             - &             -         \\
%\cmidrule(lr){2-9}
%       &         MTL     & all but miriad &              -       &             -          &  -             &  92.53 (0.30)\dag     &             - &             -         \\
\toprule
Oasis3 &         STIB    & Oasis3         &              -       &             -          &   74.47 (2.49) &   80.35 (3.59)$^{*}$  &             - &             -         \\
\cmidrule(lr){2-9}
       &         STEB    & Adni1          &              -       &             -          &   49.16 (6.34) &   48.22 (5.78)        &             - &             -         \\
       &                 & Adni2          &              -       &             -          &   67.86 (3.80) &   75.42 (4.68)$^{*}$  &             - &             -         \\
       &                 & Miriad         &              -       &             -          &   64.48 (8.65) &   62.02 (9.74)        &             - &             -         \\
%\cmidrule(lr){2-9}
%       &        MTL      & all but oasis3 &              -       &             -          &   -            &   75.43 (5.67)\dag    &             - &             -         \\
\bottomrule
\end{tabular}}
\end{table*}

\begin{table}
\centering
\caption{
Experiment of diagnosis classification run with our model.
$5$-folds classification accuracy in $\%$ is shown as mean (standard deviation). 
Experiments were run in three different conditions:
1) when training and testing data are chosen from the same dataset, or Single Task with Internal Benchmark (STIB) learning case;
2) when models trained on one dataset are tested on another dataset, or Single Task with External Benchmark (STEB) case;
3) when models are trained on all the available datasets except the testing one, or Multi Task Learning (MTL).
	In all cases we measure a better performance in the MTL condition with respect to the average STEB one (\dag).
}
\label{tab:classifier_mtl}
\resizebox{\columnwidth}{!}{
\begin{tabular}{llll}
\toprule
        & classification task & AD vs MCI         & AD vs NC           \\
\toprule
test dataset & condition      &                   &                    \\
\cmidrule(lr){1-2}
Adni1        & STIB           &  72.87 (4.37)     &   81.51 (3.14)     \\
%            & ST + TL (best) &  58.96 (3.55)     &   80.82 (3.16)     \\
	     & STEB (avg)     &  52.79 (5.79)     &   72.30 (4.13)     \\
%            & MTL            &  56.17 (4.29)\dag &   74.48 (3.06)\dag \\
             & MTL            &  59.30 (2.08)\dag &   81.86 (3.26)\dag \\
\midrule
Adni2        & STIB           &  80.07 (2.53)     &   87.92 (3.46)     \\
%            & ST + TL (best) &  63.98 (3.30)     &   75.72 (1.90)     \\
	     & STEB (avg)     &  61.11 (3.09)     &   70.04 (4.20)     \\
%            & MTL            &  68.46 (1.31)\dag &   83.89 (1.93)\dag \\
             & MTL            &  67.82 (1.91)\dag &   85.16 (2.13)\dag \\
\midrule
Geneva       & STIB           &  77.70 (8.12)     &              -     \\
%            & ST + TL (best) &  70.11 (2.90)     &              -     \\
	     & STEB (avg)     &  50.10 (4.20)     &              -     \\
%            & MTL            &  56.70 (4.13)\dag &              -     \\
             & MTL            &  52.54 (4.82)\dag &              -     \\
\midrule
Miriad       & STIB           &             -     &  86.70 (15.68)     \\
%            & ST + TL (best) &             -     &  78.90 (11.54)     \\
	     & STEB (avg)     &             -     &  73.04 (15.09)     \\
%            & MTL            &             -     &  92.53 (0.30)\dag  \\
             & MTL            &             -     &  98.46 (3.44)\dag  \\
\midrule
Oasis3       & STIB           &             -     &   80.35 (3.59)     \\
%            & ST + TL (best) &             -     &   75.42 (4.68)     \\
	     & STEB (avg)     &             -     &   61.89 (6.73)     \\
%            & MTL            &             -     &   75.43 (5.67)\dag \\
             & MTL            &             -     &   77.70 (4.22)\dag \\
\bottomrule
\end{tabular}}
\end{table}

\begin{table}
\centering
\caption{
	Classification task.
	Results stratified by the number of layers in the encoder-decoder architecture.
}
\label{tab:classifier_mtl_nl}
\resizebox{\columnwidth}{!}{
\begin{tabular}{ccccc}
\toprule
	\#layers    &            1   &            2   &            3   &            4  \\
\midrule
	MTL (avg)   &                &                &                &               \\
\cmidrule(lr){1-1}
	AD vs NC    &  85.79 (3.26)  &  79.04 (5.56)  &  79.78 (5.92)  &  82.47 (4.11) \\
	AD vs MCI   &  59.89 (2.94)  &  56.93 (5.02)  &  56.55 (5.33)  &  57.49 (6.03) \\
\bottomrule
\end{tabular}
}
\end{table}
